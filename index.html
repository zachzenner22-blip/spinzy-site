<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spinzy</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%23ff006e%22 /></svg>">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      transition: background 0.3s, color 0.3s;
    }
    :root {
      --bg: #f4f4f4;
      --fg: #222;
      --card: #fff;
      --glass: rgba(255,255,255,0.7);
    }
    [data-theme="dark"] {
      --bg: #121212;
      --fg: #eee;
      --card: #1e1e1e;
      --glass: rgba(30,30,30,0.7);
    }
    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      backdrop-filter: blur(10px);
      background: var(--glass);
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 10;
    }
    header h1 {
      margin: 0;
      font-size: 1.5rem;
      color: #ff006e;
    }
    .toolbar {
      display: flex;
      gap: 0.5rem;
    }
    button {
      background: #ff006e;
      border: none;
      color: white;
      padding: 0.4rem 0.7rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s;
    }
    button:hover {
      background: #d4005a;
    }
    main {
      margin-top: 4rem;
      display: grid;
      gap: 1rem;
      padding: 1rem;
    }
    .wheel-card {
      background: var(--card);
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    canvas {
      display: block;
      margin: 0 auto;
    }
    .title-input {
      font-size: 1.2rem;
      font-weight: bold;
      width: 100%;
      border: none;
      background: transparent;
      color: inherit;
      text-align: center;
    }
    .winner-box {
      margin-top: 1rem;
      text-align: center;
      font-size: 1.2rem;
      font-weight: bold;
    }
    .confetti {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸŽ¡ Spinzy</h1>
    <div class="toolbar">
      <button id="addWheel">+ Wheel</button>
      <button id="clearAll">Clear All Wheels</button>
      <button id="toggleTheme">ðŸŒ—</button>
    </div>
  </header>
  <main id="wheelContainer"></main>
  <div class="confetti" id="confetti"></div>

  <audio id="confettiSound" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>

  <script>
    const container = document.getElementById('wheelContainer');
    const confettiContainer = document.getElementById('confetti');
    const confettiSound = document.getElementById('confettiSound');

    let wheels = [];

    function createWheel(data = {title:'My Wheel', names:['Alice','Bob','Charlie']}) {
      const card = document.createElement('div');
      card.className = 'wheel-card';

      const title = document.createElement('input');
      title.className = 'title-input';
      title.value = data.title;
      card.appendChild(title);

      const canvas = document.createElement('canvas');
      canvas.width = 400; canvas.height = 400;
      card.appendChild(canvas);

      const winnerBox = document.createElement('div');
      winnerBox.className = 'winner-box';
      card.appendChild(winnerBox);

      const ctx = canvas.getContext('2d');
      let names = data.names;
      let spinning = false;
      let angle = 0;
      let spinAngle = 0;
      let pushLabel = true;

      function drawWheel() {
        const radius = canvas.width/2;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        const slice = 2*Math.PI/names.length;
        names.forEach((name,i)=>{
          ctx.beginPath();
          ctx.moveTo(radius,radius);
          ctx.arc(radius,radius,radius,i*slice+angle,(i+1)*slice+angle);
          ctx.fillStyle = `hsl(${i*360/names.length},70%,60%)`;
          ctx.fill();
          ctx.stroke();

          ctx.save();
          ctx.translate(radius,radius);
          ctx.rotate(i*slice+slice/2+angle);
          ctx.textAlign = 'right';
          ctx.fillStyle = '#000';
          ctx.font = '16px sans-serif';
          ctx.fillText(name, radius-10, 5);
          ctx.restore();
        });

        // notch
        ctx.beginPath();
        ctx.moveTo(radius,0);
        ctx.lineTo(radius-15,-20);
        ctx.lineTo(radius+15,-20);
        ctx.closePath();
        ctx.fillStyle = '#fff';
        ctx.fill();
        ctx.lineWidth = 4;
        ctx.strokeStyle = '#000';
        ctx.stroke();

        if (pushLabel) {
          ctx.fillStyle = '#ff006e';
          ctx.font = 'bold 20px sans-serif';
          ctx.textAlign = 'center';
          ctx.fillText('Push to Spin',radius,radius);
        }
      }

      function spin() {
        if (spinning) return;
        pushLabel = false;
        spinning = true;
        spinAngle = Math.random()*10+20;
        animate();
      }

      function animate() {
        if (spinAngle>0) {
          angle += spinAngle*Math.PI/180;
          spinAngle *= 0.97;
          drawWheel();
          requestAnimationFrame(animate);
        } else {
          spinning=false;
          const slice = 2*Math.PI/names.length;
          let selected = Math.floor(((2*Math.PI-angle%(2*Math.PI))% (2*Math.PI))/slice);
          const winner = names[selected];
          winnerBox.textContent = `Winner: ${winner}`;
          pushLabel = true;
          confettiBurst();
          confettiSound.play();
          drawWheel();
        }
      }

      canvas.addEventListener('click', spin);

      drawWheel();
      container.appendChild(card);
    }

    function confettiBurst() {
      for (let i=0;i<50;i++) {
        const div = document.createElement('div');
        div.style.position='absolute';
        div.style.width='8px'; div.style.height='8px';
        div.style.background=`hsl(${Math.random()*360},70%,60%)`;
        div.style.top='0px';
        div.style.left=Math.random()*100+'%';
        div.style.opacity='1';
        div.style.transform=`rotate(${Math.random()*360}deg)`;
        confettiContainer.appendChild(div);
        let fall=0;
        const anim=setInterval(()=>{
          fall+=5;
          div.style.top=fall+'px';
          if(fall>window.innerHeight) {div.remove(); clearInterval(anim);}
        },30);
      }
    }

    document.getElementById('addWheel').onclick=()=>createWheel();
    document.getElementById('clearAll').onclick=()=>{container.innerHTML='';};
    document.getElementById('toggleTheme').onclick=()=>{
      if(document.body.dataset.theme==='dark') document.body.dataset.theme='';
      else document.body.dataset.theme='dark';
    };

    createWheel();
  </script>
</body>
</html>